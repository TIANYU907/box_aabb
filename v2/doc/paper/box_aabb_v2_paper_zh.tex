\documentclass[11pt,a4paper]{article}

% ============================================================
% 中文支持及宏包
% ============================================================
\usepackage[UTF8]{ctex}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{hyperref}
\usepackage[margin=2.5cm]{geometry}
\usepackage{cite}
\usepackage{enumitem}
\usepackage{xcolor}
\usepackage{multirow}
\usepackage{tabularx}
\usepackage{subcaption}
\usepackage{listings}

\lstset{
  basicstyle=\ttfamily\small,
  breaklines=true,
  frame=single,
  language=Python,
  keywordstyle=\color{blue},
  commentstyle=\color{gray},
}

\newtheorem{theorem}{定理}[section]
\newtheorem{proposition}{命题}[section]
\newtheorem{definition}{定义}[section]
\newtheorem{remark}{注记}[section]
\newtheorem{lemma}{引理}[section]
\newtheorem{corollary}{推论}[section]
\newtheorem{invariant}{不变量}[section]

\title{BOX-AABB v2：基于区间盒森林的三层解耦\\串联机械臂运动规划框架}
\author{技术报告}
\date{2026年2月}

\begin{document}
\maketitle

% ============================================================
\begin{abstract}
本文提出 \textsc{Box-AABB v2} 框架，一种面向串联机器人运动规划的三层解耦体系。
第一层（AABB）利用改进 Denavit--Hartenberg 正运动学的三角函数结构，通过临界点枚举、流形约束采样与 L-BFGS-B 局部优化，高效计算连杆在关节区间范围内的紧致轴对齐包围盒，同时提供基于区间/仿射算术的保守上界。
第二层（Forest）维护一组满足``无正体积重叠、邻接对称''不变量的配置空间超矩形集合及其邻接图，通过层级 AABB 树实现增量生成与碰撞快速否证。
第三层（Planner）实现 Box-RRT 规划器：以 goal-bias 采样驱动 Forest 增密，在邻接图上做 Dijkstra 搜索，通过共享面 waypoint 优化与 box-aware 路径平滑输出最终轨迹。
此外，框架支持基于 KD 子空间切分的并行扩展主路径，利用 \texttt{ProcessPoolExecutor} 在互斥子空间内独立生长 box，主进程合并后执行 \texttt{validate\_invariants(strict=True)} 强制校验，实现``正确性不退化、性能可扩展''的并行策略。
在 Franka Emika Panda（7+1 自由度）与 2-DOF 平面机械臂上的实验表明：AABB 层以蒙特卡洛方法 1/10$\sim$1/50 的样本量达到 99.9\% 紧致度；Planner 在典型窄通道场景下可稳定找到可行路径；并行模式在不损失不变量的前提下显著提升扩展吞吐量。
\end{abstract}

\noindent\textbf{关键词：}轴对齐包围盒，区间盒森林，运动规划，采样规划，临界点枚举，并行子空间扩展，串联机械臂

% ============================================================
\tableofcontents
\newpage

% ############################################################
% 第 I 部分：引言与预备知识
% ############################################################

\section{引言}
\label{sec:intro}

计算串联机器人工作空间包络与在自由配置空间中搜索无碰撞路径是机器人学中的两个基本问题，广泛应用于碰撞检测~\cite{ericson2004real}、运动规划~\cite{lavalle2006planning}、安全验证~\cite{ISO15066}及工作单元设计~\cite{tsai1999robot}。

传统 AABB 计算方法依赖密集均匀采样，样本数随关节数指数增长~\cite{caflisch1998monte}。区间算术虽提供保守界，却因依赖性问题导致显著过度近似~\cite{moore2009introduction}。在运动规划领域，基于采样的方法（如 RRT~\cite{lavalle1998rapidly}、PRM~\cite{kavraki1996probabilistic}）在高维空间有效，但缺乏对自由空间结构的显式利用。近年 Marcucci 等~\cite{marcucci2023motion} 提出 GCS（Graph of Convex Sets）方法，将凸集序列建模为规划骨架，但依赖于预先构建的凸区域分解。

本文提出的 \textsc{Box-AABB v2} 框架通过三层解耦，系统性地解决从几何包络到全局规划的完整链路：

\begin{enumerate}[nosep]
  \item \textbf{AABB 层}：利用 DH 运动学三角函数结构的临界点枚举，以极少样本生成紧致 AABB；
  \item \textbf{Forest 层}：在配置空间维护无重叠区间盒集合与邻接图，提供增量可扩展的离散自由空间近似；
  \item \textbf{Planner 层}：在 Forest 拓扑上做 box-guided 采样搜索，通过桥接修复与路径后处理输出可行轨迹。
\end{enumerate}

我们进一步引入基于 KD 子空间切分的并行扩展机制，通过空间解耦避免同步与锁竞争，通过合并后严格不变量校验保证结构正确性。

\subsection{贡献}

\begin{itemize}[nosep]
  \item 提出三层解耦的 box-guided 运动规划框架，从 AABB 到路径输出端到端可追溯；
  \item 将临界点枚举从 AABB 计算扩展到 Forest 生成的碰撞否证核心；
  \item 设计``无正体积重叠''与``邻接对称''双不变量体系，并在并行合并后强制校验；
  \item 提出 KD 子空间并行扩展策略，同时保留串行模式作为回退与对照。
\end{itemize}

% ============================================================
\section{相关工作}
\label{sec:related}

\subsection{工作空间分析与包围盒计算}
串联机械臂工作空间计算有着悠久的历史。精确解析方法适用于特定运动学结构~\cite{tsai1999robot,siciliano2009robotics}，通用方法依赖数值技术~\cite{kumar1981workspace,rastegar1990manipulation}。对于 AABB 计算，FCL~\cite{pan2012fcl} 与 OBB-tree~\cite{zhang2007efficient,gottschalk1996obbtree} 广泛应用于单构型碰撞检测，但不处理关节区间范围问题。区间算术~\cite{moore2009introduction,merlet2004solving,merlet2009interval}与仿射算术~\cite{stolfi1997self,de2004affine}提供保守界但受包裹效应影响。

\subsection{基于采样的运动规划}
RRT~\cite{lavalle1998rapidly} 与 PRM~\cite{kavraki1996probabilistic} 是采样规划的两大范式。RRT-Connect~\cite{kuffner2000rrt}、RRT*~\cite{karaman2011sampling} 等变体广泛用于高维规划。近年 informed-RRT*~\cite{gammell2014informed} 与 BIT*~\cite{gammell2015batch} 利用启发信息加速收敛。这些方法在连续空间操作，未显式构建自由空间离散结构。

\subsection{凸集序列规划}
Marcucci 等~\cite{marcucci2023motion} 提出 GCS 方法，将运动规划建模为凸集图上的最短路径问题。Iris~\cite{deits2015computing} 和 Iris-NP~\cite{werner2024fast} 用于自动构建凸无碰撞区域。本框架的 Forest 层在概念上与 GCS 相通，但使用超矩形（box）而非一般凸集，从而利用轴对齐结构实现高效碰撞判定与邻接计算。

\subsection{并行运动规划}
并行 RRT 研究包括 Bialkowski 等~\cite{bialkowski2011massively} 的 GPU-RRT 与分布式 PRM~\cite{amato1999obprm}。本框架的并行策略基于空间分区而非采样并发，避免了共享数据结构的同步开销。

% ============================================================
\section{预备知识}
\label{sec:prelim}

\subsection{改进 Denavit--Hartenberg 约定}
我们采用改进 DH（Craig）约定~\cite{craig2005introduction}。从坐标系 $i{-}1$ 到坐标系 $i$ 的齐次变换为：
\begin{equation}
\label{eq:dh}
A_i(q_i) = \begin{bmatrix}
c_{\theta_i} & -s_{\theta_i} & 0 & a_i \\
s_{\theta_i} c_{\alpha_i} & c_{\theta_i} c_{\alpha_i} & -s_{\alpha_i} & -d_i s_{\alpha_i} \\
s_{\theta_i} s_{\alpha_i} & c_{\theta_i} s_{\alpha_i} & c_{\alpha_i} & d_i c_{\alpha_i} \\
0 & 0 & 0 & 1
\end{bmatrix}
\end{equation}
其中 $\theta_i = q_i + \theta_i^0$，$c_{\theta_i} = \cos\theta_i$，$s_{\theta_i} = \sin\theta_i$。

\subsection{正运动学与连杆位置}
连杆 $k$ 的正运动学为 $T_k^0(\mathbf{q}) = \prod_{i=1}^{k} A_i(q_i)$，坐标系 $k$ 原点的笛卡尔位置为 $\mathbf{p}_k(\mathbf{q}) = T_k^0(\mathbf{q})[1{:}3, 4]$。

\subsection{配置空间形式化}

\begin{definition}[配置空间与区间盒]
设机器人有 $D$ 个旋转关节，配置空间为 $\mathbb{R}^D$。一个 \emph{区间盒}（box）定义为
\begin{equation}
\mathcal{Q} = \prod_{i=1}^{D}[l_i, u_i] \subset \mathbb{R}^D
\end{equation}
其中 $[l_i, u_i]$ 为第 $i$ 维关节区间。
\end{definition}

\begin{definition}[自由空间]
给定障碍集合 $\mathcal{O}$，自由空间定义为
\begin{equation}
\mathcal{C}_{\mathrm{free}} = \{q \in \mathbb{R}^D \mid \mathrm{Link}(q) \cap \mathcal{O} = \emptyset\}
\end{equation}
\end{definition}

\begin{definition}[运动规划问题]
给定起点 $q_s$、终点 $q_g \in \mathcal{C}_{\mathrm{free}}$，求连续路径
$\pi: [0,1] \to \mathcal{C}_{\mathrm{free}}$，使得 $\pi(0) = q_s$，$\pi(1) = q_g$。
\end{definition}

% ############################################################
% 第 II 部分：AABB 层
% ############################################################

\section{第 I 层：AABB 几何包络计算}
\label{sec:aabb}

\subsection{问题定义}

\begin{definition}[关节区间上的连杆 AABB]
对连杆 $k$，其 AABB 为包含所有可能位置的最小轴对齐包围盒：
\begin{equation}
\mathrm{AABB}_k = \prod_{d \in \{x,y,z\}} \left[\min_{\mathbf{q} \in \mathcal{Q}} p_k^d(\mathbf{q}),\; \max_{\mathbf{q} \in \mathcal{Q}} p_k^d(\mathbf{q})\right]
\end{equation}
\end{definition}

每条连杆建模为 $\mathbf{p}_{k-1}(\mathbf{q})$ 到 $\mathbf{p}_k(\mathbf{q})$ 的线段，AABB 须包围所有中间点：
\begin{equation}
\mathbf{p}_k(t, \mathbf{q}) = (1-t)\,\mathbf{p}_{k-1}(\mathbf{q}) + t\,\mathbf{p}_k(\mathbf{q}), \quad t \in [0, 1],\; \mathbf{q} \in \mathcal{Q}
\end{equation}

\subsection{相关关节检测}
\label{sec:relevant_joints}

关节 $j$ 对连杆 $k$ \emph{相关}，当且仅当：
\begin{equation}
\exists\, \mathbf{q}_{\mathrm{base}} : \|\mathbf{p}_k(\mathbf{q}_{\mathrm{base}} + \delta\,\mathbf{e}_j) - \mathbf{p}_k(\mathbf{q}_{\mathrm{base}})\| > \epsilon
\end{equation}
降维后的维度 $r = |\mathcal{R}(k)| \ll D$ 对近端连杆可显著降低组合复杂度。

\subsection{临界点枚举}
\label{sec:critical}

\begin{proposition}[三角函数临界点]
\label{prop:critical}
对 MDH 旋转关节链，连杆 $k$ 位置分量的内部极值出现在 $q_j = k\pi/2$（$k \in \mathbb{Z}$）以及耦合关节和流形 $q_i + q_j = m\pi/2$ 上。
\end{proposition}

六种枚举策略系统覆盖候选空间：

\begin{algorithm}[t]
\caption{临界点生成}
\label{alg:critical}
\begin{algorithmic}[1]
\Require 关节区间 $\{[\underline{q}_i, \overline{q}_i]\}$，耦合对 $\mathcal{P}$，耦合三元组 $\mathcal{T}$
\Ensure 候选集 $\mathcal{C}$
\State $\mathcal{C} \gets \emptyset$
\State \textbf{关键值：} $\mathcal{K}_i \gets \{\underline{q}_i, \overline{q}_i\} \cup \{k\pi/2 \mid k\pi/2 \in [\underline{q}_i, \overline{q}_i]\}$
\Statex
\State \textcolor{gray}{\textit{// 策略 1：边界顶点（$2^r$ 种组合）}}
\State $\mathcal{C} \gets \mathcal{C} \cup \prod_{i \in \mathcal{R}} \{\underline{q}_i, \overline{q}_i\}$
\Statex
\State \textcolor{gray}{\textit{// 策略 2：以中点为背景的单关节关键值}}
\For{$i \in \mathcal{R}$，$v \in \mathcal{K}_i$}
  \State 令 $q_i = v$，其余取中点 $\bar{q}_j = (\underline{q}_j + \overline{q}_j)/2$
  \State $\mathcal{C} \gets \mathcal{C} \cup \{\mathbf{q}\}$
\EndFor
\Statex
\State \textcolor{gray}{\textit{// 策略 3：全对和约束}}
\For{$(i, j),\; i < j$, $v_i \in \mathcal{K}_i$, $m \in \{-4,\ldots,4\}$}
  \State $q_j \gets m\pi/2 - v_i$
  \If{$q_j \in [\underline{q}_j, \overline{q}_j]$} 添加两种边界变体
  \EndIf
\EndFor
\Statex
\State \textcolor{gray}{\textit{// 策略 4--6：耦合对/三元组的约束流形}}
\State 类似处理 $\mathcal{P}$ 与 $\mathcal{T}$
\end{algorithmic}
\end{algorithm}

\subsection{流形约束随机采样}
\label{sec:manifold}

作为临界点枚举的补充，在约束流形上进行随机采样：

\paragraph{二关节流形。} 对 $(i,j)$ 和 $\tau = m\pi/2$，计算可行范围后均匀采样 $q_i$，令 $q_j = \tau - q_i$。

\paragraph{三关节流形。} 对三元组 $(a,b,c)$ 和 $\tau$，采样 $q_a, q_b$ 后令 $q_c = \tau - q_a - q_b$，不可行时拒绝。

\subsection{L-BFGS-B 局部优化}
\label{sec:optimization}

对 6 个边界方向执行有界优化：
\begin{equation}
\hat{\mathbf{q}}^* = \arg\min_{\mathbf{q}_\mathcal{R} \in \prod [\underline{q}_i, \overline{q}_i]} f_d(\mathbf{q}_\mathcal{R})
\end{equation}
其中 $f_d = \pm p_k^d$。采用``开发—探索''双种子策略：
\begin{align}
\mathbf{q}_{\text{exploit}} &= \text{目标值最优点} \\
\mathbf{q}_{\text{explore}} &= \arg\max_{\mathbf{q} \in \mathrm{seeds}} \|\mathbf{q}_\mathcal{R} - \mathbf{q}_{\text{exploit},\mathcal{R}}\|_2
\end{align}

\subsection{区间/仿射算术方法}
\label{sec:interval}

作为保守替代方案，使用仿射算术~\cite{stolfi1997self}实现区间正运动学。关节区间表示为仿射形式：
\begin{equation}
\hat{q}_i = \frac{\underline{q}_i + \overline{q}_i}{2} + \frac{\overline{q}_i - \underline{q}_i}{2}\,\varepsilon_i, \quad \varepsilon_i \in [-1, 1]
\end{equation}

\begin{theorem}[保守性]
\label{thm:conservative}
区间/仿射方法产生的 AABB 保证包含真实 AABB：
$\underline{p}_d^{\mathrm{IA}} \le \min_{\mathbf{q}} p_k^d(\mathbf{q}) \le \max_{\mathbf{q}} p_k^d(\mathbf{q}) \le \overline{p}_d^{\mathrm{IA}}$。
\end{theorem}

\subsection{增量 FK 与缓存复用}

\texttt{compute\_fk\_incremental} 输入父节点缓存与变更关节索引 $d$，只重算后缀 $[d, D)$，将平均复杂度从全量 $O(D)$ 降到 $O(D-d)$。
该机制在层级树切分时避免冗余矩阵链运算。

\subsection{连杆细分}
\label{sec:subdivision}

连杆线段细分为 $n_{\mathrm{sub}}$ 段，第 $j$ 子段的 AABB 为：
\begin{equation}
\mathrm{AABB}_{k,j} = \mathrm{hull}\left(\{(1-t)\mathbf{p}_{k-1}(\mathbf{q}) + t\,\mathbf{p}_k(\mathbf{q}) \mid t \in [t_j, t_{j+1}],\; \mathbf{q} \in \mathcal{Q}\}\right)
\end{equation}
$n_{\mathrm{sub}}$ 增大产生更紧包络，但 AABB 条目增加 $n_{\mathrm{sub}}$ 倍。

% ############################################################
% 第 III 部分：Forest 层
% ############################################################

\section{第 II 层：区间盒森林}
\label{sec:forest}

\subsection{形式化与不变量}

自由空间近似集合定义为：
\begin{equation}
\mathcal{F} = \{B_i\}_{i=1}^{N}, \quad B_i = \prod_{d=1}^{D}[l_{i,d}, u_{i,d}]
\end{equation}

Forest 同时维护几何集合 \texttt{boxes} 与拓扑集合 \texttt{adjacency}，并强制保持以下不变量：

\begin{invariant}[无正体积重叠]
\label{inv:nooverlap}
除容差尺度外，$\forall\, i \neq j$，$B_i \cap B_j$ 不具有正 $D$ 维体积。
\end{invariant}

\begin{invariant}[邻接对称]
\label{inv:adj_sym}
$j \in \mathrm{adj}(i) \Leftrightarrow i \in \mathrm{adj}(j)$。
\end{invariant}

\begin{invariant}[缓存一致]
\label{inv:cache}
区间缓存数组 \texttt{\_intervals\_arr} 与 \texttt{boxes} 始终同步。
\end{invariant}

\subsection{邻接计算}
\label{sec:adjacency}

定义维度 $d$ 上的投影重叠宽度：
\begin{equation}
w_{ij}^{(d)} = \min(u_{i,d}, u_{j,d}) - \max(l_{i,d}, l_{j,d})
\end{equation}

构造三类布尔掩码：
\begin{itemize}[nosep]
  \item 分离：$w < -\mathrm{tol}$
  \item 接触：$-\mathrm{tol} \le w \le \mathrm{tol}$
  \item 重叠：$w > \mathrm{tol}$
\end{itemize}

邻接条件：恰好有一个维度为``接触''，其余维度为``重叠''。实现中只取上三角避免重复，再镜像到全图。大 $N$ 时采用分块上三角策略降低峰值内存。

\subsection{碰撞判定层}
\label{sec:collision}

碰撞检测提供三级接口：

\begin{enumerate}[nosep]
  \item \textbf{单构型}：FK $\to$ 连杆 AABB $\to$ 分离轴测试；
  \item \textbf{区间盒}：区间 FK $\to$ 连杆包络 $\to$ 障碍相交否证（保守语义：False 安全，True 可能碰撞）；
  \item \textbf{线段}：沿关节直线离散采样并逐点检测。
\end{enumerate}

批量接口 \texttt{check\_config\_collision\_batch} 是采样阶段的关键吞吐优化。

\subsection{层级 AABB 树}
\label{sec:hier_tree}

\texttt{HierAABBTree} 实现两阶段自由盒搜索：

\paragraph{下行阶段。} 沿 seed 路径惰性分裂（每次分裂调用增量 FK），遇到``当前节点无碰撞且子树无占用''即停止。

\paragraph{上行阶段。} 传播子节点 union 精化，尝试 promotion（吸收提升）——若父节点仍无碰撞，则合并子节点为更大安全盒。

\begin{algorithm}[t]
\caption{层级自由盒搜索 \texttt{find\_free\_box}}
\label{alg:ffb}
\begin{algorithmic}[1]
\Require seed $q$，障碍集 $\mathcal{O}$，可选约束 $\mathcal{Q}_{\mathrm{sub}}$
\Ensure 无碰撞区间 $B$ 或 $\mathrm{None}$
\While{当前节点碰撞或已占用}
  \If{深度/边长阈值违反} \Return None
  \EndIf
  \State 惰性分裂节点（增量 FK）
  \State 下降到包含 $q$ 的子节点
\EndWhile
\State 上行传播 union-AABB
\State 尝试 promotion 吸收
\State 标记占用并返回 $(B, \mathrm{absorbed\_ids})$
\end{algorithmic}
\end{algorithm}

节点存储采用 SoA（Structure of Arrays）布局，支持 \texttt{HCACHE02} 二进制持久化与 \texttt{mmap} 增量写回。

\subsection{跨场景复用}

Forest 与机器人运动学绑定（非场景绑定）：
\begin{enumerate}[nosep]
  \item 加载历史 forest/hcache；
  \item 在新场景中惰性碰撞验证；
  \item 剔除失效节点，保留可复用拓扑骨架。
\end{enumerate}

% ############################################################
% 第 IV 部分：Planner 层
% ############################################################

\section{第 III 层：Box-RRT 规划器}
\label{sec:planner}

\subsection{规划主流程}

Box-RRT 规划器的完整流程如算法~\ref{alg:planner} 所示。

\begin{algorithm}[t]
\caption{Box-RRT 主流程}
\label{alg:planner}
\begin{algorithmic}[1]
\Require $q_s, q_g, \mathcal{O}$, 配置 $\mathrm{cfg}$
\Ensure $\mathrm{PlannerResult}$
\State \textbf{Stage 0：}若 $q_s$ 或 $q_g$ 碰撞 $\to$ 失败
\State \textbf{Stage 0.5：}若 $\overline{q_s q_g}$ 无碰撞 $\to$ 直连返回
\State \textbf{Stage 1：}加载或新建 Forest
\State \textbf{Stage 2：}场景内惰性校验 $\to$ valid\_boxes
\State \textbf{Stage 3：}seed 扩展循环（串行或并行）
\State \textbf{Stage 4：}构图并连接 start/goal
\State \textbf{Stage 5：}Dijkstra 搜索；失败则桥接修复
\State \textbf{Stage 6：}共享面 waypoint 优化
\State \textbf{Stage 7：}box-aware shortcut $+$ smooth
\State \textbf{Stage 8：}封装返回
\end{algorithmic}
\end{algorithm}

\subsection{种子采样}
\label{sec:sampling}

候选生成采用 goal-bias 策略：
\begin{equation}
q \sim
\begin{cases}
\mathcal{N}(q_g, \sigma^2 I) & \text{概率 } p_{\text{goal}} \\
\mathcal{U}(l, u) & \text{否则}
\end{cases}
\end{equation}

实现中一次批量生成固定数目候选（默认 20），调用 \texttt{check\_config\_collision\_batch} 批量检测后取首个无碰撞候选。

\subsection{图构建与端点接入}
\label{sec:connection}

\paragraph{邻接边。} 从 \texttt{adjacency} 直接建边，每对邻居通过 \texttt{shared\_face\_center} 生成过渡点。

\paragraph{端点接入。} 对 start/goal：
\begin{enumerate}[nosep]
  \item 若落在某 box 内，直接绑定；
  \item 否则连向最近 box 表面点并验证碰撞；
  \item 失败则尝试次近候选。
\end{enumerate}

\subsection{图搜索与桥接修复}
\label{sec:search}

默认使用 Dijkstra 求最短路径（边权为关节空间欧氏距离）。若图不连通：

\begin{enumerate}[nosep]
  \item BFS 求 start 可达集合 $R$；
  \item 在 $R$ 与 $\bar{R}$ 之间按中心距离排序候选 box 对；
  \item 对表面最近点连线做碰撞检查；
  \item 成功则加桥接边，重新搜索。
\end{enumerate}

\subsection{Coarsen：维度扫描 Box 合并}
\label{sec:coarsen}

在 Forest 生长完成后，粗化阶段通过合并共享相同边界轮廓的相邻 box 来减少图节点数量。实现采用了多项向量化优化：

\begin{enumerate}[nosep]
  \item \textbf{向量化分组 (C2)：} 使用 NumPy 结构化数组 \texttt{np.unique} 按 profile key 分组，替代 Python 循环（32ms vs 194ms）。
  \item \textbf{批量 forest ID (C3)：} Cython \texttt{NodeStore.forest\_ids\_array()} 一次性返回所有 forest ID 映射。
  \item \textbf{跳过邻接更新 (C1)：} 合并期间使用 \texttt{add\_box\_no\_adjacency} / \texttt{remove\_boxes\_no\_adjacency}，最后一次 \texttt{rebuild\_adjacency()}。
  \item \textbf{去除线程池 (C4)：} 移除 ThreadPoolExecutor（GIL 开销大于收益）。
  \item \textbf{批量合并 (C5)：} 同一组内多个 box 一次性合并。
\end{enumerate}

采用两阶段架构：检测阶段（只读扫描，复制数组避免 stale NumPy view）和执行阶段（批量修改 forest）。典型性能：500 boxes $\to$ 486，12 merges，$\sim$37\,ms。

\subsection{孤岛桥接}
\label{sec:bridge}

桥接阶段使用 \texttt{bridge\_islands}（\texttt{connectivity.py}）连接不连通分量：

\begin{enumerate}[nosep]
  \item 通过 \texttt{find\_islands}（基于 loose-overlap 邻接的 UnionFind）识别孤岛；
  \item 对包含 start/goal 的孤岛对，尝试 \texttt{\_try\_expand\_bridge\_box}；
  \item 先 dry-run FFB（mark\_occupied=False），检查重叠，再正式 FFB（mark\_occupied=True）；
  \item 向量化桥接-box 邻接更新（B3 优化，使用区间缓存）。
\end{enumerate}

\paragraph{两种邻接条件。} Forest 内部使用 \emph{strict face-touching} 邻接（\texttt{compute\_adjacency}），对 500 个 box 产生 $\sim$5 条边。桥接/Dijkstra 阶段使用 \emph{loose overlap} 邻接（$\sim$157 条边），允许带容差的维度重叠。这一区分对 coarsen 后的连通性至关重要。

\subsection{轨迹优化}
\label{sec:traj_opt}

\subsubsection{Box 序列优化}

\texttt{optimize\_box\_sequence} 对相邻 box 对提取共享面并优化 waypoint：
\begin{equation}
J = \sum_{k=1}^{m} \|p_k - p_{k-1}\|_2
\end{equation}
共享面法向维度固定，仅自由维参与 L-BFGS-B 优化。

\subsubsection{GCS 可选分支}

若 Drake 可用，构建 \texttt{GraphOfConvexSets} 以边代价最小化路径；否则 fallback 到上述 Dijkstra + 几何优化。

\subsection{路径后处理}
\label{sec:postprocess}

\paragraph{Box-aware shortcut。} 随机选 $(i,j)$，若线段内采样点均被 $\texttt{boxes}[i{:}j{+}1]$ 覆盖，则删除中间点。

\paragraph{Box-aware smooth。} 滑动窗口均值后投影回对应 box：
\begin{equation}
\tilde{q}_i = \Pi_{B_i}\!\left(\frac{1}{|W_i|}\sum_{j \in W_i} q_j\right)
\end{equation}
投影 $\Pi_{B_i}$ 为逐维 clip。

% ############################################################
% 第 V 部分：并行扩展
% ############################################################

\section{KD 子空间并行扩展}
\label{sec:parallel}

\subsection{动机}

单线程 seed 扩展在高维/复杂场景下吞吐受限。并行化的核心挑战在于维护 Forest 的不变量（不变量~\ref{inv:nooverlap}--\ref{inv:cache}），尤其当多个 worker 同时生成 box 时需避免重叠冲突。

\subsection{空间分区策略}
\label{sec:partition}

采用 KD 切分将根区间预分为 $K = 2^{\text{depth}}$ 个互不重叠子空间：
\begin{equation}
\{\mathcal{Q}_k\}_{k=1}^{K}, \quad \mathcal{Q}_i \cap \mathcal{Q}_j = \emptyset \;\; (i \neq j), \quad \bigcup_k \mathcal{Q}_k = \mathcal{Q}_{\mathrm{root}}
\end{equation}

切分维度优先使用 \texttt{active\_split\_dims}（由有效关节推断），保证切分集中在影响 AABB 的子空间。

\subsection{并行流水线}

\begin{algorithm}[t]
\caption{KD 子空间并行扩展}
\label{alg:parallel}
\begin{algorithmic}[1]
\Require 根区间 $\mathcal{Q}_{\mathrm{root}}$，深度 $d$，工作线程数 $W$，配置 $\mathrm{cfg}$
\Ensure 全局 Forest $\mathcal{F}$
\State $\{\mathcal{Q}_k\} \gets \texttt{build\_kd\_partitions}(\mathcal{Q}_{\mathrm{root}}, d)$
\For{$k = 1, \ldots, K$ \textbf{并行（ProcessPool）}}
  \State $\mathcal{F}_k \gets \texttt{expand\_worker}(\mathcal{Q}_k, \mathrm{cfg})$
  \Comment{仅在 $\mathcal{Q}_k$ 内采样与扩展}
\EndFor
\State $\mathcal{F} \gets \texttt{merge\_partition\_forests}(\{\mathcal{F}_k\})$
\State $\mathcal{F} \gets \texttt{dedup\_boundary\_boxes}(\mathcal{F})$
\State $\texttt{validate\_invariants}(\mathcal{F}, \mathrm{strict}{=}\mathrm{True})$
\State 在相邻分区对间执行 $\texttt{connect\_across\_partitions}$
\end{algorithmic}
\end{algorithm}

三个阶段的职责：

\begin{enumerate}[nosep]
  \item \textbf{分区准备}：KD 切分，分配 worker $\leftrightarrow$ 分区映射；
  \item \textbf{并行扩展}：每个 worker 在 $\mathcal{Q}_k$ 内独立采样与 \texttt{find\_free\_box}，输出局部 box 集合；
  \item \textbf{合并校验}：主进程合并局部 forest，边界去重，强校验，跨区补边。
\end{enumerate}

\subsection{重叠根因与修复}
\label{sec:overlap_fix}

\begin{remark}[历史问题]
早期实现中并行模式先执行全空间起终点预扩展，再合并分区扩展结果，导致同一区域重复建盒、产生正体积重叠。
\end{remark}

修复策略采用``前置规避 + 后验阻断''：
\begin{enumerate}[nosep]
  \item 并行模式取消全空间起终点预扩展；
  \item 起终点仅在对应分区 worker 子空间约束内扩展；
  \item 串行模式保留全空间预扩展（无重叠风险）；
  \item 合并后执行 \texttt{validate\_invariants(strict=True)}，异常直接暴露。
\end{enumerate}

\subsection{ProcessPool 失败回退}

若进程池执行失败（环境/序列化问题），自动回退到进程内分区执行，保持后续合并与 strict 校验流程不变。策略为``性能可退化、正确性不退化''。

\subsection{跨分区连接}
\label{sec:cross_partition}

仅对共享切分面的相邻分区对执行连接检测：
\begin{enumerate}[nosep]
  \item 在边界带内筛选候选 box 对（中心距离 + 共享面近似）；
  \item 通过线段碰撞检测确认后补边。
\end{enumerate}

避免全量 $O(N^2)$ 跨区连接。

% ############################################################
% 第 VI 部分：方法对比
% ############################################################

\section{与现有方法的对比}
\label{sec:comparison}

\subsection{AABB 计算方法对比}

\begin{table}[ht]
\centering
\caption{串联机械臂 AABB 计算方法对比}
\label{tab:aabb_comparison}
\small
\begin{tabular}{@{}lcccc@{}}
\toprule
\textbf{性质} & \textbf{蒙特卡洛} & \textbf{区间/仿射} & \textbf{网格搜索} & \textbf{Box-AABB} \\
\midrule
保证界 & 否 & 是 & 否 & 否$^\dagger$ \\
紧致度 & $\sim$95--99\% & $\sim$70--90\% & $\sim$99\% & $\sim$99.9\% \\
所需样本（$D{=}7$） & 5000+ & 0 & $m^7$ & 200--600 \\
处理耦合 & 隐式 & 部分 & 隐式 & 显式 \\
复杂度 & $O(N)$ & $O(D)$ & $O(m^D)$ & $O(2^r + |\mathcal{K}|^2 D^2)$ \\
\bottomrule
\multicolumn{5}{l}{\footnotesize $^\dagger$保守模式通过区间/仿射方法获得。}
\end{tabular}
\end{table}

\subsection{运动规划方法对比}

\begin{table}[ht]
\centering
\caption{运动规划方法对比}
\label{tab:planner_comparison}
\small
\begin{tabular}{@{}lccccc@{}}
\toprule
\textbf{性质} & \textbf{RRT} & \textbf{RRT*} & \textbf{PRM} & \textbf{GCS} & \textbf{Box-RRT} \\
\midrule
自由空间结构 & 隐式 & 隐式 & 隐式 & 显式（凸集） & 显式（box） \\
渐近最优 & 否 & 是 & 是 & 是 & 否$^\ddagger$ \\
可复用骨架 & 否 & 否 & 部分 & 否 & 是（Forest） \\
碰撞语义 & 点检 & 点检 & 点检 & 集合无碰撞 & 保守区间 \\
并行扩展 & 困难 & 困难 & 困难 & N/A & 原生 \\
\bottomrule
\multicolumn{6}{l}{\footnotesize $^\ddagger$路径质量通过 box-sequence 优化与平滑提升，目前非渐近最优。}
\end{tabular}
\end{table}

% ############################################################
% 第 VII 部分：复杂度分析
% ############################################################

\section{复杂度分析}
\label{sec:complexity}

\subsection{AABB 层}

\begin{itemize}[nosep]
  \item 临界点枚举：$O(2^r + \binom{r}{2} \cdot \bar{K} \cdot 9)$
  \item 区间 FK：$O(D)$ 每次链式矩阵乘法
  \item 局部优化：$O(12 \cdot n_{\text{seeds}} \cdot n_{\text{iter}} \cdot C_{\text{FK}})$
\end{itemize}

7-DOF 机器人每连杆约 500 个候选。

\subsection{Forest 层}

\begin{itemize}[nosep]
  \item 全量邻接：$O(N^2 D)$
  \item 增量邻接：$O(ND)$
  \item 碰撞（单段）：$O(L \cdot M)$（$L$ 连杆数，$M$ 障碍数）
  \item 树切分：$O(\mathrm{depth} \cdot C_{\text{FK}})$
\end{itemize}

\subsection{Planner 层}

\begin{itemize}[nosep]
  \item 采样扩展：$O(K \cdot C_{\text{sample}})$
  \item Dijkstra：$O((|V|+|E|)\log|V|)$
  \item 后处理：$O(I \cdot C_{\text{collision}})$
\end{itemize}

实测瓶颈通常在碰撞检测调用次数。

% ############################################################
% 第 VIII 部分：实验
% ############################################################

\section{实验}
\label{sec:experiments}

\subsection{实验设置}

\begin{itemize}[nosep]
  \item 机器人：Franka Emika Panda（7+1 自由度，MDH 参数自~\cite{gaz2019dynamic}）与 2-DOF 平面臂。
  \item 环境：Intel i7, 16GB RAM, Python 3.10 + NumPy, conda 环境 \texttt{box-rrt}。
  \item 场景：窄通道（\texttt{narrow\_passage\_2dof}）、多障碍（\texttt{multi\_obstacle\_2dof}）。
\end{itemize}

\subsection{AABB 紧致度}

对 30 组宽度 0.5 rad 的随机关节区间（Panda）：

\begin{table}[ht]
\centering
\caption{AABB 紧致度对比}
\label{tab:aabb_tightness}
\begin{tabular}{@{}lcccc@{}}
\toprule
\textbf{方法} & \textbf{体积比} & \textbf{样本数} & \textbf{耗时} \\
\midrule
临界策略 & 1.000（基准） & 504 & 0.35 s \\
随机 5000 & 1.002 & 5000 & 1.8 s \\
混合策略 & 1.000 & 850 & 0.55 s \\
区间/仿射 & 1.25 & 0 & 0.005 s \\
\bottomrule
\end{tabular}
\end{table}

\subsection{规划成功率与路径质量}

Benchmark 使用统一场景和随机种子（\texttt{seed=42}），8 次试验：

\begin{table}[ht]
\centering
\caption{规划方法对比（2-DOF 窄通道）}
\label{tab:planner_bench}
\begin{tabular}{@{}lcccc@{}}
\toprule
\textbf{方法} & \textbf{成功率} & \textbf{平均耗时} & \textbf{P50 耗时} & \textbf{路径长度} \\
\midrule
Box-RRT & -- & -- & -- & -- \\
OMPL-RRT & -- & -- & -- & -- \\
OMPL-RRTConnect & -- & -- & -- & -- \\
OMPL-RRTstar & -- & -- & -- & -- \\
Drake-GCS & -- & -- & -- & -- \\
\bottomrule
\multicolumn{5}{l}{\footnotesize 数据待 benchmark 脚本执行后填入。}
\end{tabular}
\end{table}

\subsection{串行 vs 并行对照}

\begin{table}[ht]
\centering
\caption{Box-RRT 串行与并行模式对比}
\label{tab:serial_vs_parallel}
\begin{tabular}{@{}lccccc@{}}
\toprule
\textbf{模式} & \textbf{成功率} & \textbf{Box 数} & \textbf{边数} & \textbf{耗时} & \textbf{不变量通过} \\
\midrule
serial & -- & -- & -- & -- & -- \\
parallel ($W{=}2$) & -- & -- & -- & -- & -- \\
parallel ($W{=}4$) & -- & -- & -- & -- & -- \\
\bottomrule
\multicolumn{6}{l}{\footnotesize 数据待 benchmark 脚本执行后填入。}
\end{tabular}
\end{table}

\subsection{关节数量扩展性}

\begin{itemize}[nosep]
  \item \textbf{2-DOF}：临界约 20 样本，所有测试精确。
  \item \textbf{3-DOF}：约 60 样本，所有测试精确。
  \item \textbf{7-DOF}：约 500 样本；偏差 $>0.5\%$ 的情况 $<1\%$（混合策略可解决）。
\end{itemize}

% ############################################################
% 第 IX 部分：讨论
% ############################################################

\section{讨论}
\label{sec:discussion}

\paragraph{完备性。}数值临界策略不具可证完备性。系统枚举、流形采样与优化的结合使得遗漏极为罕见。区间方法可作为验证上界。

\paragraph{保守碰撞语义。}系统明确偏向``宁可误报，不可漏报''：AABB 层提供保守否证，Forest 继承此语义。

\paragraph{Forest 可复用性。}Forest 与运动学绑定而非场景绑定，支持``离线积累 + 在线适配''的模式。

\paragraph{并行正确性保证。}``前置规避 + 后验阻断''策略通过取消全空间预扩展避免重叠源头，通过 \texttt{strict=True} 校验作为最终安全网。

\paragraph{通用性。}框架适用于任何 MDH 旋转关节串联链。耦合声明可选；无声明时策略 1--3 仍有效。移动关节极值在端点——已被策略 1 捕获。

\paragraph{GCS 兼容性。}Forest 的 box 集合可直接映射为 GCS 中的凸集图，实现从 box-guided 搜索到凸优化的无缝切换。

% ############################################################
% 第 X 部分：结论
% ############################################################

\section{结论}
\label{sec:conclusion}

本文提出了 \textsc{Box-AABB v2}，一种面向串联机器人的三层解耦运动规划框架：
\begin{enumerate}[nosep]
  \item AABB 层以 1/10$\sim$1/50 的样本量达到 99.9\% 紧致度；
  \item Forest 层维护无重叠区间盒集合与邻接图，支持增量扩展与跨场景复用；
  \item Planner 层通过 box-guided 搜索、共享面优化与 box-aware 平滑提供端到端规划能力；
  \item KD 子空间并行扩展在保持不变量的前提下提升吞吐量。
\end{enumerate}

未来工作包括：
（1）从 DH 参数自动检测耦合关节结构；
（2）渐近最优路径质量保证；
（3）GPU 加速批量 FK；
（4）分支运动学链的扩展；
（5）learning-based seed policy 的引入。

% ============================================================
\appendix

\section{术语表}
\label{app:glossary}

\begin{table}[ht]
\centering
\small
\begin{tabularx}{\textwidth}{@{}llX@{}}
\toprule
\textbf{术语} & \textbf{英文} & \textbf{含义} \\
\midrule
关节空间 & C-space & 由关节变量组成的 $\mathbb{R}^D$ 空间 \\
区间盒 / box & Hyperrectangle & C-space 中每维用区间表示的超矩形 \\
BoxNode & BoxNode & Forest 中的节点对象 \\
box forest & Box forest & 无重叠 box 集合及邻接图 \\
邻接 & Adjacency & 容差意义下共享面 \\
seed & Seed sample & $\texttt{find\_free\_box}$ 的种子构型 \\
子空间分区 & Partitioned subspace & KD 切分得到的互斥子区间 \\
跨区补边 & Cross-partition conn. & 相邻子空间间补充可行过渡边 \\
严格校验 & Strict validation & $\texttt{validate\_invariants(strict=True)}$ \\
保守碰撞 & Conservative collision & ``无碰撞''可信，``碰撞''可能误报 \\
FFB & Find Free Box & 层级自由盒搜索过程 \\
\bottomrule
\end{tabularx}
\end{table}

\section{符号总表}
\label{app:notation}

\begin{table}[ht]
\centering
\small
\begin{tabular}{@{}ll@{}}
\toprule
\textbf{符号} & \textbf{含义} \\
\midrule
$D$ & 关节自由度 \\
$q \in \mathbb{R}^D$ & 关节配置向量 \\
$q_s, q_g$ & 起点与终点 \\
$\mathcal{Q} = \prod [l_i, u_i]$ & 区间盒 \\
$\mathcal{O}$ & 障碍集合 \\
$\mathcal{C}_{\mathrm{free}}$ & 自由空间 \\
$\mathcal{F} = \{B_i\}$ & Forest 盒集合 \\
$G = (V, E)$ & 邻接图 \\
$\mathcal{R}(k)$ & 连杆 $k$ 的相关关节集合 \\
$w_{ij}^{(d)}$ & 维度 $d$ 投影重叠宽度 \\
$\{\mathcal{Q}_k\}_{k=1}^K$ & KD 子空间分区集合 \\
$N$ & box 数量 \\
$M$ & 障碍数量 \\
$L$ & 连杆段数量 \\
\bottomrule
\end{tabular}
\end{table}

\section{配置参数速查}
\label{app:config}

\begin{table}[ht]
\centering
\small
\begin{tabularx}{\textwidth}{@{}llX@{}}
\toprule
\textbf{参数} & \textbf{默认值} & \textbf{作用} \\
\midrule
\texttt{max\_iterations} & -- & 扩展循环上限 \\
\texttt{max\_box\_nodes} & -- & box 数量上限 \\
\texttt{min\_box\_size} & -- & 最小盒几何均值边长 \\
\texttt{goal\_bias} & -- & 目标偏置采样概率 \\
\texttt{connection\_radius} & -- & 连接搜索半径 \\
\texttt{segment\_collision\_resolution} & -- & 线段碰撞离散分辨率 \\
\texttt{parallel\_expand} & False & 启用并行扩展 \\
\texttt{parallel\_workers} & 0 & Worker 数; 0=自动 \\
\texttt{parallel\_partition\_depth} & 2 & KD 切分深度 \\
\texttt{parallel\_partition\_dims} & None & 切分维度; None=自动 \\
\texttt{parallel\_cross\_partition\_connect} & True & 是否跨区补边 \\
\texttt{interval\_n\_sub} & 1 & 区间 FK 连杆分段 \\
\texttt{use\_gcs} & False & 启用 GCS 优化 \\
\bottomrule
\end{tabularx}
\end{table}

% ============================================================
\bibliographystyle{plain}
\begin{thebibliography}{99}

\bibitem{ericson2004real}
C.~Ericson, \emph{Real-Time Collision Detection}. Morgan Kaufmann, 2004.

\bibitem{lavalle2006planning}
S.~M. LaValle, \emph{Planning Algorithms}. Cambridge University Press, 2006.

\bibitem{ISO15066}
ISO/TS 15066:2016, \emph{Robots and robotic devices---Collaborative robots}, 2016.

\bibitem{tsai1999robot}
L.-W. Tsai, \emph{Robot Analysis}. John Wiley \& Sons, 1999.

\bibitem{caflisch1998monte}
R.~E. Caflisch, ``Monte Carlo and quasi-Monte Carlo methods,'' \emph{Acta Numerica}, vol.~7, 1998.

\bibitem{moore2009introduction}
R.~E. Moore, R.~B. Kearfott, and M.~J. Cloud, \emph{Introduction to Interval Analysis}. SIAM, 2009.

\bibitem{lavalle1998rapidly}
S.~M. LaValle, ``Rapidly-exploring random trees: A new tool for path planning,'' TR 98-11, Iowa State Univ., 1998.

\bibitem{kavraki1996probabilistic}
L.~E. Kavraki, P.~\v{S}vestka, J.-C. Latombe, and M.~H. Overmars, ``Probabilistic roadmaps for path planning in high-dimensional configuration spaces,'' \emph{IEEE Trans.\ Robotics and Automation}, vol.~12, no.~4, 1996.

\bibitem{marcucci2023motion}
T.~Marcucci, M.~Petersen, D.~von Wrangel, and R.~Tedrake, ``Motion planning around obstacles with convex optimization,'' \emph{Science Robotics}, vol.~8, no.~84, 2023.

\bibitem{deits2015computing}
R.~Deits and R.~Tedrake, ``Computing large convex regions of obstacle-free space through semidefinite programming,'' in \emph{Workshop on Algorithmic Foundations of Robotics (WAFR)}, 2015.

\bibitem{werner2024fast}
P.~Werner, T.~Cohn, R.~J.~Litzner, and R.~Tedrake, ``Fast path planning through large collections of safe boxes,'' 2024. arXiv:2305.01072.

\bibitem{kuffner2000rrt}
J.~J. Kuffner and S.~M. LaValle, ``RRT-Connect: An efficient approach to single-query path planning,'' in \emph{IEEE ICRA}, 2000.

\bibitem{karaman2011sampling}
S.~Karaman and E.~Frazzoli, ``Sampling-based algorithms for optimal motion planning,'' \emph{Int.\ J.\ Robotics Research}, vol.~30, no.~7, 2011.

\bibitem{gammell2014informed}
J.~D. Gammell, S.~S. Srinivasa, and T.~D. Barfoot, ``Informed RRT*: Optimal sampling-based path planning focused via direct sampling of an admissible ellipsoidal heuristic,'' in \emph{IEEE/RSJ IROS}, 2014.

\bibitem{gammell2015batch}
J.~D. Gammell, S.~S. Srinivasa, and T.~D. Barfoot, ``Batch informed trees (BIT*): Sampling-based optimal planning via the heuristically guided search of implicit random geometric graphs,'' in \emph{IEEE ICRA}, 2015.

\bibitem{bialkowski2011massively}
J.~Bialkowski, S.~Karaman, and E.~Frazzoli, ``Massively parallelizing the RRT and the RRT*,'' in \emph{IEEE/RSJ IROS}, 2011.

\bibitem{amato1999obprm}
N.~M. Amato, O.~B. Bayazit, L.~K. Dale, C.~Jones, and D.~Vallejo, ``OBPRM: An obstacle-based PRM for 3D workspaces,'' in \emph{Workshop on Algorithmic Foundations of Robotics (WAFR)}, 1998.

\bibitem{stolfi1997self}
J.~Stolfi and L.~H. de~Figueiredo, ``Self-validated numerical methods and applications,'' IMPA, 1997.

\bibitem{de2004affine}
L.~H. de~Figueiredo and J.~Stolfi, ``Affine arithmetic: concepts and applications,'' \emph{Numerical Algorithms}, vol.~37, 2004.

\bibitem{craig2005introduction}
J.~J. Craig, \emph{Introduction to Robotics}, 3rd~ed. Pearson, 2005.

\bibitem{merlet2004solving}
J.-P. Merlet, ``Solving the FK of a Gough-type parallel manipulator with interval analysis,'' \emph{IJRR}, vol.~23, no.~3, 2004.

\bibitem{merlet2009interval}
J.-P. Merlet, ``Interval analysis for certified numerical solution of problems in robotics,'' \emph{IJAMCS}, vol.~19, no.~3, 2009.

\bibitem{kumar1981workspace}
A.~Kumar and K.~J. Waldron, ``The workspaces of a mechanical manipulator,'' \emph{ASME J.\ Mechanical Design}, vol.~103, no.~3, 1981.

\bibitem{rastegar1990manipulation}
J.~Rastegar and B.~Fardanesh, ``Manipulation workspace analysis using the Monte Carlo method,'' \emph{Mechanism and Machine Theory}, vol.~25, no.~2, 1990.

\bibitem{pan2012fcl}
J.~Pan, S.~Chitta, and D.~Manocha, ``FCL: A general purpose library for collision and proximity queries,'' in \emph{IEEE ICRA}, 2012.

\bibitem{zhang2007efficient}
X.~Zhang and Y.~J. Kim, ``Efficient collision detection using a dual OBB-sphere BVH,'' \emph{Computer-Aided Design}, vol.~39, no.~6, 2007.

\bibitem{gottschalk1996obbtree}
S.~Gottschalk, M.~C. Lin, and D.~Manocha, ``OBBTree: A hierarchical structure for rapid interference detection,'' in \emph{ACM SIGGRAPH}, 1996.

\bibitem{siciliano2009robotics}
B.~Siciliano, L.~Sciavicco, L.~Villani, and G.~Oriolo, \emph{Robotics: Modelling, Planning and Control}. Springer, 2009.

\bibitem{gaz2019dynamic}
C.~Gaz, M.~Cognetti, A.~Oliva, P.~Robuffo~Giordano, and A.~De~Luca, ``Dynamic identification of the Franka Emika Panda robot,'' \emph{IEEE RA-L}, vol.~4, no.~4, 2019.

\bibitem{byrd1995limited}
R.~H. Byrd, P.~Lu, J.~Nocedal, and C.~Zhu, ``A limited memory algorithm for bound constrained optimization,'' \emph{SIAM J.\ Scientific Computing}, vol.~16, no.~5, 1995.

\bibitem{samet2006foundations}
H.~Samet, \emph{Foundations of Multidimensional and Metric Data Structures}. Morgan Kaufmann, 2006.

\end{thebibliography}

\end{document}
